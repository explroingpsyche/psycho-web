<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Psychology Portal</title>
  <link rel="stylesheet" href="./assets/css/style.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      background: #f8f9fa;
      padding: 50px 0;
    }

    .footer {
      background: linear-gradient(135deg, #000000 0%, #764ba2 100%);
      color: white;
      padding: 40px 0 20px;
      margin-top: 50px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .footer-content {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 40px;
      margin-bottom: 30px;
    }

    .footer-brand {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo::before {
      content: "üß†";
      font-size: 28px;
    }

    .footer-text {
      font-size: 14px;
      opacity: 0.9;
      line-height: 1.5;
    }

    .contact-info {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
    }

    .contact-item span {
      opacity: 0.8;
    }

    .footer-section h3 {
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: 600;
    }

    .footer-links {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .footer-links a {
      color: white;
      text-decoration: none;
      font-size: 14px;
      opacity: 0.8;
      transition: opacity 0.3s ease;
    }

    .footer-links a:hover {
      opacity: 1;
    }

    .newsletter-form {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .input-field {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 25px;
      outline: none;
      font-size: 14px;
    }

    .btn {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .social-links {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      color: white;
      text-decoration: none;
      font-size: 18px;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-3px);
    }

    .footer-bottom {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding-top: 20px;
      text-align: center;
    }

    .copyright {
      font-size: 14px;
      opacity: 0.8;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .footer-content {
        grid-template-columns: 1fr;
        gap: 30px;
        text-align: center;
      }

      .contact-info {
        align-items: center;
      }

      .newsletter-form {
        flex-direction: column;
        gap: 15px;
      }

      .btn {
        padding: 12px 30px;
      }

      .social-links {
        justify-content: center;
      }

      .footer {
        padding: 30px 0 15px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 0 15px;
      }

      .footer-content {
        gap: 25px;
      }

      .logo {
        font-size: 20px;
      }

      .logo::before {
        font-size: 24px;
      }
    }
  </style>
  <style>
    .dropdown {
      position: relative;
    }

    .dropdown-menu {
      display: none;
      position: absolute;
      background-color: #fff;
      padding: 10px 0;
      min-width: 160px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }

    .dropdown:hover .dropdown-menu {
      display: block;
    }

    .dropdown-link {
      display: block;
      padding: 8px 16px;
      text-decoration: none;
      color: #333;
      white-space: nowrap;
    }

    .dropdown-link:hover {
      background-color: #f2f2f2;
    }

    .navbar-link .arrow {
      font-size: 1.6rem;
      margin-left: 4px;
    }

    .navbar-link {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Additional styles for the new cards and underline functionality */
    .category-card.active {
      border-bottom: 3px solid var(--active-color);
    }

    .category-card {
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-card:hover {
      transform: translateY(-5px);
    }

    #documents-content,
    #books-content {
      display: none;
    }

    #documents-content.show,
    #books-content.show {
      display: block;
    }

    .document-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .document-card {
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }

    .document-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .document-icon {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .document-name {
      font-weight: bold;
      margin-bottom: 5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .document-meta {
      display: flex;
      justify-content: space-between;
      color: #666;
      font-size: 14px;
    }

    .document-link {
      color: white;
      text-decoration: none;
    }

    .document-link:hover {
      text-decoration: underline;
    }

    .empty-message {
      text-align: center;
      padding: 40px;
      color: #666;
      font-size: 18px;
    }

    .loading {
      text-align: center;
      padding: 20px;
      color: #666;
    }

    .error {
      text-align: center;
      padding: 20px;
      color: #e74c3c;
    }
  </style>
</head>

<body>
  <header class="header" data-header>
    <div class="container">
      <a href="#" class="logo">
        <img src="./assets/images/psy.png" alt="Psychology Portal logo" style="height: 60px; width: 130px;">
      </a>
      <nav class="navbar" data-navbar>
        <div class="wrapper">
          <a href="#" class="logo">
            <img src="./assets/images/psy.png" alt="Psychology Portal logo" style="height: 30px; width: 50px;">
          </a>
          <button class="nav-close-btn" aria-label="close menu" data-nav-toggler>
            <ion-icon name="close-outline" aria-hidden="true"></ion-icon>
          </button>
        </div>
        <ul class="navbar-list">
          <li class="navbar-item">
            <a href="./index.html" class="navbar-link" data-nav-link>Home</a>
          </li>
          <li class="navbar-item">
            <a href="./about.html" class="navbar-link" data-nav-link>About</a>
          </li>
          <li class="navbar-item">
            <a href="./books.html" class="navbar-link" data-nav-link>Library</a>
          </li>
          <li class="navbar-item">
            <a href="./blog.html" class="navbar-link" data-nav-link>Blog</a>
          </li>
          <li class="navbar-item">
            <a href="#footer" class="navbar-link" data-nav-link>Contact</a>
          </li>
        </ul>
      </nav>
      <div class="header-actions">
        <button class="header-action-btn" aria-label="toggle search" title="Search">
          <ion-icon name="search-outline" aria-hidden="true"></ion-icon>
        </button>
        <a href="#" class="btn has-before">
          <span class="span">Learn more</span>
          <ion-icon name="arrow-forward-outline" aria-hidden="true"></ion-icon>
        </a>
        <button class="header-action-btn" aria-label="open menu" data-nav-toggler>
          <ion-icon name="menu-outline" aria-hidden="true"></ion-icon>
        </button>
      </div>
      <div class="overlay" data-nav-toggler data-overlay></div>
    </div>
  </header>

  <section class="section" id="resources">
    <div class="container">
      <h3 class="h2 section-title" style="margin-top: 30px;">Psychology Resources Library</h3>
      <p class="section-text">
        Browse through our collection of shared psychology resources.
      </p>

      <!-- Documents Content -->
      <div id="documents-content" class="show">
        <div id="document-container">
          <div class="loading">Loading documents...</div>
        </div>
      </div>

      <!-- Books Content -->
      <div id="books-content">
        <div id="books-container">
          <div class="empty-message">No books found. Please check back later.</div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer" id="footer">
      <div class="container">
          <div class="footer-content">
              <!-- Brand Section -->
              <div class="footer-brand">
                  <a href="#" class="logo">Psych-Exploration</a>
                  <p class="footer-text">
                      Advancing psychological knowledge through innovative learning solutions.
                  </p>
                  <div class="contact-info">
                      <!-- <div class="contact-item">
                          <span>üìç</span>
                          <span>Housing Colony Layyah, City Layyah</span>
                      </div> -->
                      <div class="contact-item">
                          <span>üìû</span>
                          <a href="tel:+923116721128" style="color: white; text-decoration: none;">+923116721128</a>
                      </div>
                      <div class="contact-item">
                          <span>‚úâÔ∏è</span>
                          <a href="mailto:mzmazhar4@gmail.com" style="color: white; text-decoration: none;">mzmazhar4@gmail.com</a>
                      </div>
                  </div>
              </div>

              <!-- Quick Links -->
              <div class="footer-section">
                  <h3>Quick Links</h3>
                  <ul class="footer-links">
                      <li><a href="./books.html">Books</a></li>
                      <li><a href="./books.html">Courses</a></li>
                      <li><a href="./books.html">Notes</a></li>
                  </ul>
              </div>

              <!-- Newsletter -->
              <div class="footer-section">
                  <h3>Stay Connected</h3>
                  <p class="footer-text">Subscribe for latest psychology research and resources.</p>
                  <form class="newsletter-form">
                      <input type="email" class="input-field" placeholder="Your email" required>
                      <button type="submit" class="btn">Subscribe</button>
                  </form>
                  <!-- <div class="social-links">
                      <a href="#" class="social-link">üìò</a>
                      <a href="#" class="social-link">üíº</a>
                      <a href="#" class="social-link">üì∑</a>
                      <a href="#" class="social-link">üê¶</a>
                  </div> -->
              </div>
          </div>

          <div class="footer-bottom">
              <p class="copyright">
                  ¬© 2025 Psych Exploration. All rights reserved.
              </p>
          </div>
      </div>
  </footer>

  <a href="#top" class="back-top-btn" aria-label="back top top" data-back-top-btn>
    <ion-icon name="chevron-up" aria-hidden="true"></ion-icon>
  </a>

  <script src="./assets/js/script.js" defer></script>
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <script>
    // Replace with your Google Drive folder ID for documents
    const DOCUMENTS_FOLDER_ID = '15yjms__oTYQRZDUoJMfIutDBA7mz7Ezg';
    // Replace with your Google Drive folder ID for books
    const BOOKS_FOLDER_ID = 'YOUR_BOOKS_FOLDER_ID';
    // Replace with your API key
    const API_KEY = 'AIzaSyC0GplBLR0Sz-bHfzIN3RGJN_KSm4fD4qU';
    const DOCS_PER_PAGE = 50;

    let allFiles = [];
    let currentPage = 1;
    let currentContentType = 'documents'; // Default to documents

    // Function to handle card clicks
    function setupCardToggle() {
      const cards = document.querySelectorAll('.category-card');

      cards.forEach(card => {
        card.addEventListener('click', function () {
          // Remove active class from all cards
          cards.forEach(c => c.classList.remove('active'));

          // Add active class to clicked card
          this.classList.add('active');

          // Get the content type to show
          const contentType = this.getAttribute('data-content');
          currentContentType = contentType;

          // Hide all content sections
          document.getElementById('documents-content').classList.remove('show');
          document.getElementById('books-content').classList.remove('show');

          // Show the selected content section
          document.getElementById(`${contentType}-content`).classList.add('show');

          // Load content if not already loaded
          if (contentType === 'documents' && allFiles.length === 0) {
            fetchAllDriveDocuments();
          }
        });
      });
    }

    async function fetchAllDriveDocuments() {
      try {
        let pageToken = '';

        do {
          const response = await fetch(
            `https://www.googleapis.com/drive/v3/files?q='${DOCUMENTS_FOLDER_ID}'+in+parents&key=${API_KEY}&fields=files(id,name,webViewLink,mimeType),nextPageToken&pageSize=100${pageToken ? `&pageToken=${pageToken}` : ''}`
          );

          if (!response.ok) {
            throw new Error('Failed to fetch documents');
          }

          const data = await response.json();
          allFiles = [...allFiles, ...data.files];
          pageToken = data.nextPageToken || '';

          // Show loading progress
          document.getElementById('document-container').innerHTML =
            `<div class="loading">Loading documents... (${allFiles.length} loaded so far)</div>`;

        } while (pageToken);

        // Sort files alphabetically by name
        allFiles.sort((a, b) => a.name.localeCompare(b.name));
        displayDocuments();
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('document-container').innerHTML =
          '<div class="error">Failed to load documents. Please try again later.</div>';
      }
    }

    function displayDocuments() {
      const container = document.getElementById('document-container');

      if (!allFiles || allFiles.length === 0) {
        container.innerHTML = '<div class="empty-message">No documents found in this folder.</div>';
        return;
      }

      const totalPages = Math.ceil(allFiles.length / DOCS_PER_PAGE);
      const startIdx = (currentPage - 1) * DOCS_PER_PAGE;
      const endIdx = startIdx + DOCS_PER_PAGE;
      const currentFiles = allFiles.slice(startIdx, endIdx);

      // Build the UI
      let html = `
            <div class="document-controls">
                <div class="document-search">
                    <input type="text" id="document-search-input" placeholder="Search documents...">
                    <button id="search-button" class="search-button">Search</button>
                </div>
                <div class="pagination-info">
                    Showing ${startIdx + 1}-${Math.min(endIdx, allFiles.length)} of ${allFiles.length} documents
                </div>
            </div>
            
            <div class="document-grid">
        `;

      currentFiles.forEach(file => {
        const fileType = getFileType(file.mimeType);
        const fileIcon = getFileIcon(file.mimeType);
        const isPDF = file.mimeType.includes('pdf');

        html += `
                <div class="document-card">
                    <div class="document-icon">${fileIcon}</div>
                    <div class="document-info">
                        <div class="document-name" title="${file.name}">${file.name}</div>
                        <div class="document-meta">
                            <span class="document-type">${fileType}</span>
                            <a href="${file.webViewLink || `https://drive.google.com/file/d/${file.id}/view`}" 
                               target="_blank" 
                               class="document-link ${isPDF ? 'pdf-view' : ''}">
                                ${isPDF ? 'PDF View' : 'View'}
                            </a>
                        </div>
                    </div>
                </div>
            `;
      });

      html += `
            </div>
            
            <div class="pagination-controls">
                <button id="prev-page" class="pagination-button" ${currentPage === 1 ? 'disabled' : ''}>
                    Previous
                </button>
                <span class="page-indicator">
                    Page ${currentPage} of ${totalPages}
                </span>
                <button id="next-page" class="pagination-button" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next
                </button>
            </div>
        `;

      container.innerHTML = html;

      // Add event listeners
      document.getElementById('prev-page')?.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          displayDocuments();
        }
      });

      document.getElementById('next-page')?.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          displayDocuments();
        }
      });

      document.getElementById('search-button')?.addEventListener('click', searchDocuments);
      document.getElementById('document-search-input')?.addEventListener('keyup', function (e) {
        if (e.key === 'Enter') searchDocuments();
      });
    }

    function searchDocuments() {
      const searchTerm = document.getElementById('document-search-input').value.toLowerCase();
      if (!searchTerm) {
        currentPage = 1;
        displayDocuments();
        return;
      }

      const filteredFiles = allFiles.filter(file =>
        file.name.toLowerCase().includes(searchTerm)
      );

      if (filteredFiles.length === 0) {
        document.getElementById('document-container').innerHTML =
          '<div class="empty-message">No documents match your search.</div>';
        return;
      }

      // Display search results (temporarily replace allFiles)
      const originalFiles = allFiles;
      allFiles = filteredFiles;
      currentPage = 1;
      displayDocuments();

      // Add a button to clear search
      const container = document.getElementById('document-container');
      const clearButton = document.createElement('button');
      clearButton.className = 'clear-search';
      clearButton.textContent = 'Clear Search';
      clearButton.addEventListener('click', () => {
        allFiles = originalFiles;
        currentPage = 1;
        displayDocuments();
      });

      const controls = container.querySelector('.document-controls');
      if (controls) {
        controls.appendChild(clearButton);
      }
    }

    function getFileType(mimeType) {
      if (mimeType.includes('pdf')) return 'PDF';
      if (mimeType.includes('word')) return 'DOC';
      if (mimeType.includes('presentation')) return 'PPT';
      if (mimeType.includes('spreadsheet')) return 'Sheet';
      return 'File';
    }

    function getFileIcon(mimeType) {
      if (mimeType.includes('pdf')) return 'üìÑ';
      if (mimeType.includes('word')) return 'üìù';
      if (mimeType.includes('presentation')) return 'üìä';
      if (mimeType.includes('spreadsheet')) return 'üìà';
      return 'üìÅ';
    }

    // Load documents when page loads
    window.addEventListener('DOMContentLoaded', function () {
      setupCardToggle();
      fetchAllDriveDocuments();
    });
  </script>

</html>